<!DOCTYPE html>
<html lang="en" ng-app="TodoList">
<head>
    <meta charset="utf-8">
    <title>To-do list</title>
    <link rel="stylesheet" href="Content/bootstrap.css">
    <link rel="stylesheet" href="Content/style.css">
</head>
<body ng-controller="TodoListController as list">
    <h1>To-do list</h1>

    <form method="get" id="search-form" ng-submit="getQueryResults()">
        <input type="text" ng-model="query" ng-change="getQueryResults()">
        <input type="submit" value="Search">
    </form>

    <div id="main">
        <article ng-repeat="task in tasks track by $index" ng-class="task.IsCompleted ? 'completed-task' : 'uncompleted-task'" id="{{task.Id}}">
            <h3 ng-bind-html="$sce.trustAsHtml(task.Title)"></h3>
            <p>{{task.Description}}</p>
            <small>Date: {{task.PublishDate | date: 'MM/dd/yyyy @ h:mma'}}</small>
            <footer>
                <small>
                    Is completed: <input type="checkbox" ng-checked="{{task.IsCompleted}}" ng-click="task.IsCompleted = !task.IsCompleted;"/> | <a href="#" ng-click="editTask($index)">Edit</a> | <a href="#" ng-click="deleteTask($index)">Delete</a>
                </small>
            </footer>
        </article>
    </div>

    <input type="button" id="create-button" class="btn btn-info" ng-click="createTask()" value="Create new item" />

    <form method="post" id="popup" ng-show="isVisiblePopup" ng-submit="submitNewTask()">
        <input type="hidden" value="0" ng-model="id">

        <label for="title">Title:</label>
        <input type="text" ng-model="title" required/>

        <label for="description">Description:</label>
        <textarea ng-model="description"></textarea>

        <div>
            <input type="submit" class="btn" value="Submit"/>
            <input type="button" class="btn" value="Close" ng-click="isVisiblePopup = false" />
        </div>
    </form>

    <div id="error-popup" ng-show="isVisibleErrorPopup">
        <h3>Error: <span ng-bind="errorStatusCode"></span></h3>
        <h4 ng-bind="errorHeader"></h4>
        <p id="error-message" ng-bind="errorMessage"></p>
        <p id="error-contact-email">E-mail us: <a href="mailto:example@site.com">Support Team</a></p>
        <input type="button" value="Close" ng-click="isVisibleErrorPopup = false">
    </div>

    <footer class="main-footer">
        Created by <a href="https://github.com/ilia-valchenko/Todolist" target="_blank" title="Check out my project on GitHub">Ilya Valchanka</a>.
    </footer>

    <script src="Scripts/angular.js"></script>
    <script src="Scripts/angular-sanitize.js"></script>
    <script src="Scripts/jquery-3.1.1.js"></script>
    <script src="Scripts/repository.js"></script>
    <script src="Scripts/script.js"></script>
</body>
</html>